# 📊 Multi-Factor Spectral AI Strategy（MSAI）
### 多因智慧光譜策略｜多因子 + PLS 降維 + LightGBM 選股框架

---

## 📌 策略命名由來

> **"Multi-Factor Spectral AI Strategy (MSAI)"** 是一套以機器學習為核心，融合多維市場訊號的動態選股系統。

命名含義如下：

- **Multi-Factor**：代表策略結合四大類因子來源 —— 籌碼、營收、技術面與歷史報酬，反映市場行為全貌。
- **Spectral（光譜）**：呼應策略使用 **PLS（Partial Least Squares）降維技術**，如同將多維訊號「光譜化」為潛在結構因子（latent factors）。
- **AI Strategy**：核心模型採用 **LightGBM**，為具可解釋性的非線性機器學習方法，適應不同市況並提升預測力。

---

## 📈 策略績效總覽（2016–2024）

> 策略針對台股進行滾動視窗回測，週期設定為：**2 年訓練 + 1 年驗證 + 1 個月測試**。以下為績效摘要與圖表展示。

### 🔹 策略 vs Benchmark 累積報酬

![累積報酬圖](./images/累積報酬率.png)

### 🔹 策略月報酬率熱力圖（年度 × 月份）

![報酬熱力圖](./images/報酬熱力圖.png)

---

### 📊 關鍵績效指標比較

| 指標項目               | 策略表現 | Benchmark 表現 |
|------------------------|---------:|----------------:|
| 年化報酬率 (%)          |    17.05 |           15.53 |
| 年化波動率 (%)          |    15.47 |           15.71 |
| Sharpe Ratio           |     1.10 |            0.99 |
| Sortino Ratio          |     1.98 |            1.76 |
| 勝率 (%)               |    68.22 |           67.29 |
| 最大回撤 (%)           |   -19.68 |          -20.95 |
| Calmar Ratio           |     0.87 |            0.74 |
| 盈虧比（P/L Ratio）    |     1.13 |            1.09 |

---

## 🔍 策略核心設計理念

本策略從以下四類因子出發，經由 PLS 降維後交由 LightGBM 學習非線性結構，並利用滾動視窗定期更新模型以因應市場變化。

---

### 🏦 1. 籌碼面因子：來自資訊掌握者的真實行動

機構法人（外資、投信、自營商）通常擁有更多市場資訊，其持股與週轉行為反映市場預期的方向性。  
但單一籌碼指標可能受事件擾動、訊號雜訊多，因此本策略透過 PLS 將多個籌碼變數壓縮為一組綜合性潛在因子，  
並使用滾動窗口架構，定期更新籌碼信號與市場之間的關聯強度。

---

### 📃 2. 營收面因子：經營基本面的穩定輸出

營收是企業經營的核心反映，亦為市場評價依據之一。然而其公布時間（每月 10 日）與實際操作時間（月末）存在資訊落差。

> 為平衡「即時性」與「穩定性」，本策略設計採用以下因子結構：

- 累計營收成長率
- 近三個月營收均值 vs 十二個月均值
- 歷史創新高/新低指標
- 產業類別做為補強變數

這些指標透過 PLS 結合成一個營收潛在因子，提供穩定的成長輪廓。

---

### 📈 3. 技術面因子：即時反映市場情緒與共識

技術指標如週轉率、成交比重、股價淨值比、殖利率等，是價格與量的投射，代表當前市場共識與風險偏好。

> 技術因子波動性高、變化快，因此策略將這些變數視為「即時性模組」，在滾動回測下動態調整其預測權重。

---

### 📊 4. 歷史報酬因子：融合動能與反轉訊號

大量文獻支持報酬具有預測能力，但預測方向依持有期長短而異：

- 📌 短期（20 天）偏向動能
- 📌 中期（3–6 個月）常見趨勢持續
- 📌 長期（12 個月）可能出現反轉效應

> 本策略納入多期間報酬與超額報酬，並以 PLS 統合為單一歷史報酬因子，供 LightGBM 學習時序性非線性關聯。

---

## 🧩 策略流程架構

```mermaid
graph TD
A[原始因子 (籌碼/營收/技術/報酬)] --> B[PLS 降維]
B --> C[四類潛在因子]
C --> D[LightGBM 分類模型]
D --> E[策略排序與選股]
E --> F[Rolling Window 回測]
